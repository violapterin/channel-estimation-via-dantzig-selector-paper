\Frame {Channel Model}
{
\I Consider the uniform linear array
\Disp {
\NC \V {a} \SB {\psi'}
= \NC \F {1}{\R {N_H}} \sum_{n=0}^{N-1} \Ss {e}^{n \psi' \Ss {i}} \V {u}_n
\in \MB {C} ^{N_H} \NR
}

\I Consider the channel representation
\Disp {
\NC \M{H}
=\NC \sum_{l=0} ^{L-1}
\a_l
\V {a} \SB {\f_l'}
\V {a} \SB {\th_l'}^\Adj
\in \MB {C} ^{N_H \D N_H} \NR
}

\I where \m {L} is the number of paths, \m {\f_l'} is related to the angles of arrival, \m {\th_l'} is related to the angles of arrival.
}
% XXX % % XXX % % XXX % % XXX % % XXX % % XXX %
\Frame {Precoders and Combiners}
{
\I Tx: Digital precoder \m {\M {F}_B \in \NC \MB {C} ^{N_R \D N_Y}}

\I Tx: Analog precoder \m {\NC \M {F}_R \in \NC \MB {C} ^{N_H \D N_R}}

\I Rx: Digital combiner \m {\M {W}_B \in \NC \MB {C} ^{N_R \D N_H}}

\I Rx: Analog combiner \m {\M {W}_R \in \NC \MB {C} ^{N_Y \D N_R}}

\I With the unity magnitude constraint
\Disp {
\NC \Nm {\M {F}_R \SB {n_H, n_R}}
= \NC 1,
\Q \Nm {\M {W}_R \SB {n_R, n_H}}
= 1, \NR
}

\I Under the assumption
\Disp {
\NC N_H \gg \NC N_R \gg N_Y \NR
}
}
% XXX % % XXX % % XXX % % XXX % % XXX % % XXX %
\Frame {Effective Channel}
{
\I Consider Complex Standard Normal \m {\M{Z} \in \NC \MB {C} ^{N_H \D N_H}}

\I Introduce the effective channel
\Disp {
\NC \M{Y}
:=\M{W}_B \M{W}_R \RB {\M{H} \M{F}_R \M{F}_B +\M{Z}} \NR
}

\I Summarizing the dimension,
\Disp {
\NC \MB {C}^{N_Y}
\underset {\M{F}_B} {\mapsto} \NC \MB {C}^{N_R}
\underset {\M{F}_R} {\mapsto} \MB {C}^{N_H}
\underset {\M{H}} {\mapsto} \MB {C}^{N_H}
\underset {\M{W}_R} {\mapsto} \MB {C}^{N_R}
\underset {\M{W}_B} {\mapsto} \MB {C}^{N_Y} \NR
}

\I How do we \Emph {recover} \m {\M {H}} with knowledge of \m {\M {Y}}?

\I How do we \Emph {design} \m {\M {W}_R}, \m {\M {W}_B}, \m {\M {F}_R}, and \m {\M {F}_B}?
}
% XXX % % XXX % % XXX % % XXX % % XXX % % XXX %
\Frame {Transform to the Angular Domain}
{
\I Introduce the DFT matrix \m {\M {K} \in \NC \MB {C} ^{N_H \D N_H}}, and write
\Disp {
\NC \V {y}
:= \NC \Rm {vec} \SB {\M {Y}},
\Q \M {P}
:= \RB {\M {F}_B^\Tr \M {F}_R^\Tr \M{K}^\ast} \otimes \RB {\M {W}_B \M {W}_R \M {K}}, \NR
\NC \V {g}
:= \NC \Rm {vec} \SB {\M {K}^\Adj \M {H} \M {K}},
\Q \V {z}
:= \Rm {vec} \SB {\M {Z}} \NR
}

\I Then we have a \Emph {linear equation}
\Disp {
\NC \V {y}
=\NC \M {P} \V {g} +\V {z} \NR
}
}
% XXX % % XXX % % XXX % % XXX % % XXX % % XXX %
\Frame {Proposed Method}
{
\I Input \m{\M {P} \in \MB {C} ^{N_Y^2 \D N_H^2}}, \m{\V {y} \in \MB {C} ^{N_H^2}}, \m{\g_{\Ss {DS}} \geq 0}.

\I Calculate
\Disp {
\NC \Hat {\V {g}}
\LA \NC \startcases
\NC \Min {\V {g}'}  \MC \VNm {\V {g}'} _1 \NR
\NC \Rm {subject} \; \Rm {to} \Q \MC \VNm {\M {P}^\Adj \RB {\V {y} -\M {P} \V {g}'}} _\infty \leq \g_{\Ss {DS}} \NR
\stopcases \NR
}

\I Output \m {\Hat {\M {H}} \LA \M {K} \Rm {vec}^{-1} \SB {\Hat {g}} \M {K}^\Adj}
}

